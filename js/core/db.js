// Created by Tomáš Bončo
// All rights reserved
// Licence: Do not share, do not use, do not read, simply get out :)

!function(){define(["require","inc/store"],function(a,b){var c;return Array.prototype.select=function(a,b){var c,d,e,f,g,h,i,j;if(!a)return!1;for(a.constructor!==Array&&(a=[a]),e=[],g=0,i=this.length;i>g;g++){if(c=this[g],c.constructor!==Object)return console.error("Nespr\xe1vny tvar po\u013ea, pole mus\xed obsahova\u0165 objekty"),!1;if(1===a.length&&c[a[0]])b?(d={},d[a[0]]=c[a[0]],e.push(d)):e.push(c[a[0]]);else{for(d={},h=0,j=a.length;j>h;h++)f=a[h],c[f]&&(d[f]=c[f]);e.push(d)}}return e},c=function(){return{store:b,connect:function(a){var b;if(!a)throw new Error("DB not specified");if(!a.get||!a.set)throw new Error("Not valid DB");return b=c(),b.store=a,b},create_db:function(){return{store:{},set:function(a,b){return this.store[a]=b},get:function(a){return this.store[a]},getAll:function(){return this.store},remove:function(a){return this.store[a]?delete this.store[a]:void 0},clear:function(){return this.store={}}}},use:function(a){var b;return b=this,{find:function(c){var d,e,f,g,h,i;if(i=this,f=b.store.get(a),null==f)return!1;for(d=c?f.filter(c):f,g=0,h=d.length;h>g;g++)e=d[g],e.$$index=f.indexOf(e),e.save=function(){return i.save(this)},e.remove=function(){return i.remove(this)};return 0===d.length?!1:d},findOne:function(a){var b;return b=this.find(a),b?b[0]:!1},create:function(c){var d;return d=b.store.get(a),null==d&&(d=[]),d.push(c),b.store.set(a,d),c.$$index=d.indexOf(c),c.save=function(){return _this.save(this)},c.remove=function(){return _this.remove(this)},c},createBatch:function(a){var b,c,d;for(c=0,d=a.length;d>c;c++)b=a[c],this.create(b);return!0},save:function(c){var d,e;return d=c.$$index,delete c.$$index,delete c.save,delete c.remove,e=b.store.get(a),e[d]=c,b.store.set(a,e),c.$$index=e.indexOf(c),c.save=function(){return _this.save(this)},c.remove=function(){return _this.remove(this)},!0},remove:function(c){var d;return d=b.store.get(a),d.splice(c.$$index,1),b.store.set(a,d),!0},drop:function(){return b.store.remove(a),this}}}}},c()})}.call(this);